---
title: 
date: 
categories: 
tags: 
author: 
image:
  path: 
  alt: 
---
 External USB/Device:  
o Introduction: 
• identification of any device being connected: 
o SYSTEM\CurrentControlSet\Enum\USBSTOR 
o SYSTEM\CurrentControlSet\Enum\USB 
• For first/last time the device was connected:  
o SYSTEM\CurrentControlSet\Enum\USBSTOR\Ven_Prod_Version\USBSerial\Properties\{83da
 6326-97a6-4088-9453-a19231573b29} \#### 
0064 
0066 
First connection time 
Last connection time 
0067 
Last removal time  
Values #### could take 
• USB device volume name: SOFTWARE\Microsoft\Windows\Portable Devices\Devices 
o Connection Timestamps  
• Connection timestamps determine temporal usage of specific USB devices connected to a Windows 
Machine. These are stored at the different locations based on the type of information that we need  
• First time (plug and play files) 
o These helps search for device serial number and times are set to the local time zone.  
o XP: C:\Windows\setupapi.log 
o Win7+: C:\Windows\inf\setupapi.dev.log  
• First, Last, and Removal Times 
o SYSTEM\CurrentControlSet\Enum\USBSTOR\Disk&Ven_&Prod_\USBSerial#\Properties\ 
{83da6326-97a6-4088-9453-a19231573b29} \####  
o SYSTEM\CurrentControlSet\Enum\SCSI\Ven_Prod_Version\USBSerial#\Properties\ 
{83da6326-97a6-4088-9453-a19231573b29} \####  
o Timestamps are stored in Windows 64-bit FILETIME format  
225 | H K a u r 
• Connection Times  
o Win10+: %SYSTEM ROOT%\System32\winevt\logs\Microsoft-Windows
Partition/Diagnostic.evtx  
o Event ID 1006 is recorded for each device connect/disconnect and the logs are cleared when 
major os updates occur.  
o Volume Serial Number (VSN)  
• Discover the VSN assigned to the file system partition on the USB. (NOTE: This is not the USB Unique 
Serial Number, which is hardcoded into the device firmware, nor the serial number on any external 
labels attached to the device.)  
• SOFTWARE\Microsoft\WindowsNT\CurrentVersion\EMDMgmt  
Find a key match using Volume Name and USB Unique Serial Number: 
Find last integer number in matching line  
Convert decimal value to hex serial number  
This key is often missing from modern systems using SSD devices  
• Win10+: %SYSTEM ROOT%\System32\winevt\logs\Microsoft-Windows-Partition/Diagnostic.evtx  
Event ID 1006 may include VBR data, which contains the VSN - VSN is 4 bytes located at offsets 0x43 
(FAT), 0x64 (exFAT), or 0x48 (NTFS) within each VBR - Log cleared during major OS updates  
• The VSN and device Volume Name can help correlate devices to specific files via shell items present 
in LNK files and registry locations. 
o Event Logs  
• Removable device activity can be audited in multiple Windows event logs.  
• Plug and Play driver install attempted: 
o Win7+: %SYSTEM ROOT%\System32\winevt\logs\System.evtx  
o Event IDs 20001, 20003 –  
• Security log events:  
o %SYSTEM ROOT%\System32\winevt\logs\Security.evtx  
o 4663 – Attempt to access removable storage object (Security log)  
o 4656 – Failure to access removable storage object (Security log)  
o 6416 – A new external device was recognized on system (Security log)  
o are dependent on system audit settings  
• Connection Times 
o Win10+: %SYSTEM ROOT%\System32\winevt\logs\Microsoft-Windows
Partition/Diagnostic.evtx  
o Event ID 1006 is recorded for each device connect/disconnect 
o User information: 
• This information could allow investigators to attribute a USB to a user account. 
• Document device Volume GUID from SYSTEM\MountedDevices   
• NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2  
• If a Volume GUID match is made within MountPoints2, we can conclude the associated user profile 
was logged in while that device was present. 
o LINK files
