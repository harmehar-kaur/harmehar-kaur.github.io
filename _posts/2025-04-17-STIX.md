---
title: STIX Format
date: 2025-04-17
categories: [Miscelleneous]
tags: [Cyber, CTI, STIX, STIX2]
author: Harmehar Kaur
image:
  path: /assets/cyber-prefix.png
  alt: Cyber
---


Structured Threat Information Expression (STIX) is a language and serialization format used to exchange cyber threat intelligence (CTI). With STIX, all aspects of suspicion, compromise and attribution can be represented clearly with objects and descriptive relationships. STIX information can be visually represented for an analyst or stored as JSON to be quickly machine readable.

## STIX 2.1 Domain Objects (SDOs)

STIX 2.1 defines 18 STIX Domain Objects (SDOs):

| Object               | Name             | Description |
|----------------------|------------------|-------------|
| Attack Pattern Icon  | Attack Pattern   | A type of TTP that describe ways that adversaries attempt to compromise targets. |
| Campaign Icon        | Campaign         | A grouping of adversarial behaviors that describes a set of malicious activities or attacks (sometimes called waves) that occur over a period of time against a specific set of targets. |
| Course of Action Icon| Course of Action | A recommendation from a producer of intelligence to a consumer on the actions that they might take in response to that intelligence. |
| Grouping Icon        | Grouping         | Explicitly asserts that the referenced STIX Objects have a shared context, unlike a STIX Bundle (which explicitly conveys no context). |
| Identity Icon        | Identity         | Actual individuals, organizations, or groups as well as classes of individuals, organizations, systems or groups. |
| Indicator Icon       | Indicator        | Contains a pattern that can be used to detect suspicious or malicious cyber activity. |
| Infrastructure       | Infrastructure   | Represents systems, software services, and physical or virtual resources used to support a purpose, like C2 servers. |
| Intrusion Set Icon   | Intrusion Set    | A grouped set of adversarial behaviors and resources with common properties that is believed to be orchestrated by a single organization. |
| Location Icon        | Location         | Represents a geographic location. |
| Malware Icon         | Malware          | A type of TTP that represents malicious code. |
| Malware Analysis Icon| Malware Analysis | Metadata and results of a particular static or dynamic analysis performed on a malware instance or family. |
| Note Icon            | Note             | Conveys informative text to provide further context or additional analysis. |
| Observed Data Icon   | Observed Data    | Conveys info about cyber security related entities using the STIX Cyber-observable Objects (SCOs). |
| Opinion Icon         | Opinion          | An assessment of the correctness of the information in a STIX Object. |
| Report Icon          | Report           | Collections of threat intelligence focused on one or more topics. |
| Threat Actor Icon    | Threat Actor     | Actual individuals, groups, or organizations believed to be operating with malicious intent. |
| Tool Icon            | Tool             | Legitimate software that can be used by threat actors to perform attacks. |
| Vulnerability Icon   | Vulnerability    | A mistake in software that can be used by a hacker to gain access to a system or network. |

## STIX 2.1 Relationship Objects (SROs)

| Object            | Name         | Description |
|-------------------|--------------|-------------|
| Relationship Icon | Relationship | Used to link two SDOs or SCOs to describe how they are related. |
| Sighting Icon     | Sighting     | Denotes the belief that something in CTI (e.g., an indicator, malware) was seen. |

## Scenario Overview

### STIX Producer: Company A

Company A detects malicious activity and creates an Indicator SDO with a file hash pattern. It also creates a Malware SDO for CryptoLocker. A Relationship SRO links the Indicator and Malware using `indicates`.

These objects are wrapped in a STIX Bundle and shared on a TAXII server.

### STIX Consumer: Company B

Company B receives the bundle, searches its network, and finds the malware. It then creates a Sighting SRO referencing the original Indicator and shares it back to the TAXII server.

## Objects Used in this Scenario

### Common Properties

All SDOs and SROs include common properties. Required ones include:

```json
{
  "type": "indicator",
  "id": "indicator--71312c48-925d-44b7-b10e-c11086995358",
  "created": "2017-02-06T09:13:07.243000Z",
  "modified": "2017-02-06T09:13:07.243000Z"
}
```

Updated version example:

```json
{
  "created": "2017-02-06T09:13:07.243000Z",
  "modified": "2017-07-19T04:18:09.864000Z"
}
```

### Indicator Object

```json
{
  "type": "indicator",
  "spec_version": "2.1",
  "id": "indicator--71312c48-925d-44b7-b10e-c11086995358",
  "created": "2017-02-06T09:13:07.243000Z",
  "modified": "2017-02-06T09:13:07.243000Z",
  "name": "CryptoLocker Hash",
  "description": "This file is a part of CryptoLocker",
  "pattern": "[file:hashes.'SHA-256' = '46afeb295883a5efd6639d4197eb18bcba3bff49125b810ca4b9509b9ce4dfbf']",
  "pattern_type": "stix",
  "indicator_types": ["malicious-activity"],
  "valid_from": "2017-01-01T09:00:00.000000Z"
}
```

### Malware Object

```json
{
  "type": "malware",
  "id": "malware--81be4588-96a8-4de2-9938-9e16130ce7e6",
  "spec_version": "2.1",
  "created": "2017-02-06T09:26:21.647000Z",
  "modified": "2017-02-06T09:26:21.647000Z",
  "name": "CryptoLocker",
  "description": "CryptoLocker is known to hold files hostage for ransom.",
  "malware_types": ["ransomware"]
}
```

### Relationship Object

```json
{
  "type": "relationship",
  "id": "relationship--a19fac85-f6f5-47f3-aacd-4bfb54557852",
  "spec_version": "2.1",
  "created": "2017-02-06T09:30:51.987000Z",
  "modified": "2017-02-06T09:30:51.987000Z",
  "relationship_type": "indicates",
  "source_ref": "indicator--71312c48-925d-44b7-b10e-c11086995358",
  "target_ref": "malware--81be4588-96a8-4de2-9938-9e16130ce7e6"
}
```

### STIX Bundle

```json
{
  "type": "bundle",
  "id": "bundle--1736e032-a96a-41e9-8302-126677d4d781",
  "objects": [
    {
      "type": "indicator",
      "id": "indicator--71312c48-925d-44b7-b10e-c11086995358",
      "spec_version": "2.1",
      "created": "2017-02-06T09:13:07.243000Z",
      "modified": "2017-02-06T09:13:07.243000Z",
      "name": "CryptoLocker Hash",
      "description": "This file is a part of CryptoLocker",
      "pattern": "[file:hashes.'SHA-256' = '46afeb295883a5efd6639d4197eb18bcba3bff49125b810ca4b9509b9ce4dfbf']",
      "pattern_type": "stix",
      "indicator_types": ["malicious-activity"],
      "valid_from": "2017-01-01T09:00:00.000000Z"
    },
    {
      "type": "malware",
      "id": "malware--81be4588-96a8-4de2-9938-9e16130ce7e6",
      "spec_version": "2.1",
      "created": "2017-02-06T09:26:21.647000Z",
      "modified": "2017-02-06T09:26:21.647000Z",
      "name": "CryptoLocker",
      "description": "CryptoLocker is known to be malicious ransomware.",
      "malware_types": ["ransomware"]
    },
    {
      "type": "relationship",
      "id": "relationship--a19fac85-f6f5-47f3-aacd-4bfb54557852",
      "spec_version": "2.1",
      "created": "2017-02-06T09:30:51.987000Z",
      "modified": "2017-02-06T09:30:51.987000Z",
      "relationship_type": "indicates",
      "source_ref": "indicator--71312c48-925d-44b7-b10e-c11086995358",
      "target_ref": "malware--81be4588-96a8-4de2-9938-9e16130ce7e6"
    }
  ]
}
```

### Sighting Object

```json
{
  "type": "sighting",
  "id": "sighting--4eebf1e1-5351-49ed-9b7b-28f0da806d82",
  "spec_version": "2.1",
  "created": "2017-02-07T20:08:31.154Z",
  "modified": "2017-02-07T20:08:31.154Z",
  "sighting_of_ref": "indicator--71312c48-925d-44b7-b10e-c11086995358"
}
```

## Summary

Company A shared threat intelligence using STIX Indicator and Malware objects and a relationship. Company B consumed the data and generated a Sighting SRO to report it was seen in their network.
